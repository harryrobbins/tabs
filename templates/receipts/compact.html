<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page { size: 80mm 160mm; margin: 3mm; }
        body { font-family: 'Arial Narrow', Arial, sans-serif; color: #000; line-height: 1.2; margin: 0; padding: 3mm; font-size: 9px; width: 74mm; }
        .hdr { background: #000; color: #fff; padding: 5px; text-align: center; margin-bottom: 5px; }
        .store { font-size: 13px; font-weight: bold; }
        .addr { font-size: 7px; margin-top: 2px; }
        .meta { background: #f0f0f0; padding: 4px; margin: 4px 0; font-size: 8px; }
        table { width: 100%; border-collapse: collapse; margin: 4px 0; font-size: 8px; }
        td { padding: 1px 0; }
        .desc { max-width: 50mm; }
        .price { text-align: right; font-weight: bold; }
        .qty { font-size: 7px; color: #666; }
        .tot { background: #f0f0f0; padding: 4px; margin: 5px 0; }
        .tr { display: table; width: 100%; margin: 1px 0; font-size: 8px; }
        .tl { display: table-cell; }
        .tv { display: table-cell; text-align: right; font-weight: bold; }
        .final { font-size: 11px; background: #000; color: #fff; padding: 3px; margin: 5px -3mm; }
        .pay { text-align: center; margin: 4px 0; font-size: 8px; padding: 3px; background: #f0f0f0; }
        .ft { text-align: center; font-size: 7px; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="hdr">
        <div class="store">{{ rec.store_name }}</div>
        <div class="addr">{{ rec.store_address }} | {{ rec.store_phone }}</div>
    </div>
    <div class="meta">
        #{{ rec.receipt_number }} | {{ rec.datetime.strftime('%d/%m/%y %H:%M') }} | {{ rec.transaction_id }}
    </div>
    <table>
        {% for item in rec.items %}
        <tr>
            <td class="desc">{{ item.description }}</td>
            <td class="price">£{{ "%.2f"|format(item.total) }}</td>
        </tr>
        {% if item.quantity != 1.0 %}
        <tr><td class="qty">{{ "%.1f"|format(item.quantity) }}@{{ "%.2f"|format(item.unit_price) }}</td><td></td></tr>
        {% endif %}
        {% endfor %}
    </table>
    <div class="tot">
        <div class="tr">
            <div class="tl">SUB</div>
            <div class="tv">£{{ "%.2f"|format(rec.subtotal) }}</div>
        </div>
        <div class="tr">
            <div class="tl">VAT</div>
            <div class="tv">£{{ "%.2f"|format(rec.tax_amount) }}</div>
        </div>
        <div class="tr final">
            <div class="tl">TOTAL</div>
            <div class="tv">£{{ "%.2f"|format(rec.total) }}</div>
        </div>
    </div>
    <div class="pay">{{ rec.payment_method }}{% if rec.card_last_four %} | ****{{ rec.card_last_four }}{% endif %}</div>
    <div class="ft">THANK YOU</div>
</body>
</html>
